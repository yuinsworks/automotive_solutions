(()=>{"use strict";const t="_api/tag-manager/api/v1/tags/",e=`/${t}hosts/`,n={EDITOR:"EDITOR",EDITOR_X:"EDITOR_X",ADI:"ADI",APP_BUILDER:"APP_BUILDER",BUSINESS_MANAGER:"BUSINESS_MANAGER",BUSINESS_MANAGER_EDITOR_X:"BUSINESS_MANAGER_EDITOR_X",SITES_LIST:"SITES_LIST",VIEWER:"VIEWER",LOGO_BUILDER:"LOGO_BUILDER",ART_STORE:"ART_STORE",TEMPLATES:"TEMPLATES",FUNNEL:"FUNNEL",DEV_CENTER:"DEV_CENTER",ARENA:"ARENA",LOGIN_PAGE:"LOGIN_PAGE",LOGIN_PAGE_EDITOR_X:"LOGIN_PAGE_EDITOR_X",PREMIUM:"PREMIUM",PREMIUM_TAGS:"PREMIUM_TAGS",PREMIUM_EDITOR_X_TAGS:"PREMIUM_EDITOR_X_TAGS",SUPPORT:"SUPPORT",ACCOUNT_MANAGER:"ACCOUNT_MANAGER",APP_MARKET_STANDALONE:"APP_MARKET_STANDALONE",COMPONENT_STUDIO:"COMPONENT_STUDIO",PREMIUM_DOMAINS_WHOIS:"PREMIUM_DOMAINS_WHOIS",PREMIUM_DOMAINS:"PREMIUM_DOMAINS",RELEASE_NOTES:"RELEASE_NOTES",PREMIUM_MP_CONTAINER:"PREMIUM_MP_CONTAINER",GET_FEEDBACK:"GET_FEEDBACK",MOBILE_WEB_DASHBOARD:"MOBILE_WEB_DASHBOARD",STUDIO_DASHBOARD:"STUDIO_DASHBOARD",CHANNELS_DASHBOARD:"CHANNELS_DASHBOARD",ENTERPRISE_DASHBOARD:"ENTERPRISE_DASHBOARD"},o=!!document.documentMode;function E(t,e,n){let E;o?(E=document.createEvent("CustomEvent"),E.initCustomEvent(t,!0,!0,n)):E=new CustomEvent(t,{detail:n}),e&&e.dispatchEvent&&setTimeout((()=>{e.dispatchEvent(E)}),0)}const r={TAG_MANAGER_LOADED:"TagManagerLoaded",TAGS_LOADING:"LoadingTags",TAG_LOADED:"TagLoaded",TAG_LOAD_ERROR:"TagLoadError",TAG_MANAGER_CONFIG_SET:"TagManagerConfigSet"},A="Tag Manager: ",a=function(){let t=!1;try{const e=window;t=e&&e.debug||e.location&&(e.location.search||"").toLowerCase().indexOf("debug=")>-1}catch(t){}return t}();function s(t){a&&console&&console.error(`${A} ${t}`)}function c(t){a&&console&&console.log(`${A} ${t}`)}function i(t){let e=t;try{e=JSON.parse(t)}catch(t){s("Parse error in string"),s(t.message)}return e}function _(t){return i(JSON.stringify(t))}let T=[];const O=[],R=[];let u=[],S={};function I(t){"object"!=typeof t||Array.isArray(t)||(S={...S,...t},E(r.TAG_MANAGER_CONFIG_SET,window,_(S)))}function N(t){return Object.keys(t).filter((e=>!!t[e]&&-1===u.indexOf(e)))}function d(t){O.push(t)}function D(t){R.push(t)}function M(t,e,n){const o=()=>{try{if("function"==typeof t)return t(e)}catch(t){s(t)}};return!0===n?setTimeout(o,0):o()}function f(t,e,n,o){return()=>{o(n),function(t){T=T.filter((e=>e.name!==t))}(n.name),E(t,window,{tagName:e,embed:_(n)})}}function g(t,e,n,o){const E=o&&o.headers||{},r=o&&o.query||{};E["content-type"]=E["content-type"]||"application/json";const A=new XMLHttpRequest,a=o&&o.postBody?"POST":"GET",s=`${t}${function(t){let e="";"object"==typeof t&&Object.keys(t).forEach((n=>{if(void 0!==t[n]){const o=encodeURIComponent(t[n]);e+=`${encodeURIComponent(n)}=${o}&`}}));return e=e?e.substr(0,e.length-1):"",e?`?${e}`:""}(r)}`;A.open(a,s,!0),A.onreadystatechange=()=>{if(4===A.readyState){const t=A.status;t<200||t>=300?M(n,{status:t,responseText:A.responseText}):M(e,A.responseText)}},Object.keys(E).forEach((t=>{void 0!==E[t]&&A.setRequestHeader(t,E[t])})),A.send(o&&o.postBody||null)}function l(t){T=t,E(r.TAGS_LOADING,window,t),t.forEach((t=>{!function(t,e,n,o){const E=document.createElement("SCRIPT");E.src=t,E.onload=()=>{M(e,t)},E.onerror=e=>{M(n,{error:e,sourceUrl:t})},"object"==typeof o&&Object.keys(o).forEach((t=>{E.setAttribute(t,o[t])})),document.head.appendChild(E)}(t.sourceUrl,f(r.TAG_LOADED,t.name,t,d),f(r.TAG_LOAD_ERROR,t.name,t,D))}))}function P(t){const e=i(t);var n;e.errors&&e.errors.length>0&&s(JSON.stringify(e.errors)),e.config&&((n=e.config.consentPolicy)&&"object"==typeof n&&(u=[...u,...N(n)]),I(e.config)),e.tags?l(e.tags):c("No embeds found to load")}function L(t,o){if(!t||!n.hasOwnProperty(t)){const e=`Hostname: ${t} not listed`;return c(e),new Error(e)}g(`${e}${t}`,(t=>{P(t)}),(()=>{s(`Error loading tags for host ${t}`)}),{query:{categories:o}})}let G=(t,e)=>{if(!n.hasOwnProperty(t)){const e=`${t} is not listed as a valid host`;return s(e),new Error(e)}L(t),I({language:e}),document.addEventListener("consentPolicyChanged",(e=>function(t,e,n){if(n&&n.detail&&n.detail.policy){const e=N(n.detail.policy);e.length&&L(t,e)}}(t,0,e)))};const U={init:function(t,e){const n=G(t,e);return G=()=>new Error("wixTagManager already initialised"),n},getLoadedTags:function(){return _(O)},getLoadingTags:function(){return _(T)},getLoadErrorTags:function(){return _(R)},getConfig:function(){return _(S)},HOST_NAMES:n};E(r.TAG_MANAGER_LOADED,window,U),window.wixTagManager=U})();
//# sourceMappingURL=hostTags.bundle.min.js.map